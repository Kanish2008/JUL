<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VÃ¥rt Julealbum 2024 â¤ï¸ Meghna & Kanish</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --red: #8b0000;
            --green: #114026;
            --gold: #ffd700;
            --amber: #ffb84d;
        }

        /* Clean theme overrides (applies when body[data-theme="clean"]) */
        body[data-theme="clean"] {
            --red: #4a4a4a;
            --green: #2f3a3a;
            --gold: #cfcfcf;
            --amber: #e6e6e6;
            color: #222;
            background: linear-gradient(180deg,#fbfbfb,#f3f5f7);
        }

        /* Theme toggle button (placed above music toggle) */
        #theme-toggle { position: fixed; right: 20px; bottom: 90px; z-index: 1300; }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(to bottom, var(--red) 0%, var(--green) 100%);
            color: #e6eef8;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Subtle snow particles for gentle holiday feel */
        .snowflake {
            position: fixed;
            top: -10px;
            color: rgba(255,255,255,0.9);
            font-size: 0.9em;
            font-family: Arial, sans-serif;
            filter: blur(0.6px);
            opacity: 0.06;
            animation: fall linear infinite;
            z-index: 2;
            user-select: none;
            pointer-events: none;
        }

        @keyframes fall {
            to { transform: translateY(100vh) rotate(360deg); }
        }


        /* Header - modern and minimal */
        .header {
            text-align: center;
            padding: 36px 20px;
            position: relative;
            z-index: 10;
            background: transparent;
        }

        .header h1 {
            font-family: 'Great Vibes', cursive;
            font-weight: 400;
            font-size: 3.2rem;
            background: linear-gradient(90deg,var(--gold),var(--gold) 40%, var(--amber) 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: 0.6px;
            margin-bottom: 6px;
            text-shadow: 0 6px 20px rgba(0,0,0,0.45);
        }

        @keyframes glow {
            from { text-shadow: 0 0 10px var(--gold), 0 0 20px var(--gold), 0 0 30px var(--red), 0 0 40px var(--red); }
            to { text-shadow: 0 0 20px var(--gold), 0 0 30px var(--gold), 0 0 40px var(--red), 0 0 50px var(--red); }
        }

        .header p { font-size: 1rem; color: #e9e6df; margin-top: 6px; font-weight: 300; }

        .header .hearts { display: inline-block; color: var(--red); margin-left: 8px; }

        /* String lights in header for subtle holiday accent */
        .string-lights {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 120px);
            height: 26px;
            pointer-events: none;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 5;
        }

        .string-lights span {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: linear-gradient(180deg,var(--gold),var(--amber));
            box-shadow: 0 6px 18px rgba(255,190,100,0.25);
            opacity: 0.95;
            transform-origin: center;
            animation: twinkle 2.5s infinite ease-in-out;
        }

        .string-lights span:nth-child(odd) { animation-duration: 3s; }
        .string-lights span:nth-child(even) { animation-duration: 2s; }

        @keyframes twinkle { 0%,100%{ transform: scale(1); opacity:0.9 } 50%{ transform: scale(1.35); opacity:1 } }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Decorative icons minimized for modern style */
        .decorations { display: none; }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }

        /* Intro melding */
        .intro-message {
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border-radius: 12px;
            padding: 28px;
            margin: 32px auto;
            max-width: 820px;
            box-shadow: 0 12px 40px rgba(2,6,23,0.6);
            text-align: left;
            border-left: 4px solid rgba(255, 183, 77, 0.08);
        }

        .intro-message h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 1.8rem;
            color: #fff;
            margin-bottom: 12px;
        }

        .intro-message p {
            font-size: 1rem;
            line-height: 1.6;
            color: #cbd7e6;
        }

        /* Galleri */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(2,6,23,0.6);
            cursor: pointer;
            transition: transform 0.28s ease, box-shadow 0.28s ease;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
        }

        .gallery-item:hover {
            transform: translateY(-6px);
            box-shadow: 0 18px 40px rgba(2,6,23,0.75);
        }

        .gallery-item img {
            width: 100%;
            height: 340px;
            object-fit: cover;
            display: block;
            transition: transform 0.45s cubic-bezier(.2,.8,.2,1);
            will-change: transform;
        }

        .missing-thumb {
            height: 340px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.85);
            background: linear-gradient(180deg, rgba(0,0,0,0.12), rgba(0,0,0,0.06));
            font-weight: 600;
            border-radius: 12px;
            text-align: center;
            padding: 18px;
        }

        .gallery-item:hover img { transform: scale(1.04); }

        /* Remove playful emoji overlay */
        .gallery-item::after { display: none; }

        /* Lightbox (modern) */
        .lightbox {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(2,6,23,0.85);
            backdrop-filter: blur(6px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .lightbox.active { display:flex; }

        .lightbox-content {
            width: min(1100px, 95%);
            max-height: 90vh;
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            background: linear-gradient(180deg,#061221,#071426);
            padding: 20px;
            box-shadow: 0 30px 80px rgba(2,6,23,0.7);
            animation: zoomIn 0.28s ease;
        }

        @keyframes zoomIn {
            from {
                transform: scale(0.5);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .lightbox img, .lightbox video {
            max-width: 100%;
            max-height: 70vh;
            border-radius: 10px;
            border: none;
            box-shadow: 0 10px 30px rgba(2,6,23,0.6);
        }

        .lightbox video {
            max-height: 75vh;
        }

        .gallery-item video {
            width: 100%;
            height: 400px;
            object-fit: cover;
            display: block;
            transition: transform 0.4s ease;
        }

        .gallery-item:hover video {
            transform: scale(1.1);
        }

        .play-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 68px;
            height: 68px;
            display:flex;
            align-items:center;
            justify-content:center;
            border-radius:50%;
            background: rgba(255,255,255,0.08);
            color: #ffffff;
            font-size: 28px;
            pointer-events: none;
            box-shadow: 0 8px 20px rgba(2,6,23,0.6);
        }

        .lightbox-caption {
            display: none;
        }

        .lightbox-counter {
            text-align: center;
            color: #fff;
            font-size: 1.1em;
            margin-top: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
        }

        .lightbox-thumbnails {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            max-width: 90%;
            overflow-x: auto;
            padding: 10px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--gold) rgba(0, 0, 0, 0.5);
        }

        .lightbox-thumbnails::-webkit-scrollbar {
            height: 6px;
        }

        .lightbox-thumbnails::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 3px;
        }

        .lightbox-thumbnails::-webkit-scrollbar-thumb {
            background: var(--gold);
            border-radius: 3px;
        }

        .lightbox-thumbnail {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            object-fit: cover;
            flex-shrink: 0;
        }

        .lightbox-thumbnail:hover {
            border-color: var(--gold);
            transform: scale(1.1);
        }

        .lightbox-thumbnail.active {
            border-color: #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 40px;
            font-size: 50px;
            color: var(--gold);
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        .lightbox-close:hover {
            color: #ff0000;
            transform: rotate(90deg) scale(1.2);
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 50px;
            color: var(--gold);
            cursor: pointer;
            padding: 20px;
            background: rgba(139, 0, 0, 0.7);
            border-radius: 50%;
            transition: all 0.3s ease;
            user-select: none;
        }

        .lightbox-nav:hover {
            background: rgba(255, 215, 0, 0.8);
            color: #8b0000;
            transform: translateY(-50%) scale(1.2);
        }

        .lightbox-prev {
            left: 20px;
        }

        .lightbox-next {
            right: 20px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 36px 20px;
            margin-top: 60px;
            background: transparent;
            position: relative;
            z-index: 10;
        }

        .footer p {
            font-size: 0.95em;
            color: #a9bbcf;
            font-weight: 300;
        }

        .footer .love-message {
            font-family: 'Poppins', sans-serif;
            font-size: 1.6em;
            color: var(--red);
            margin-top: 12px;
        }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 3em;
            }
            
            .header p {
                font-size: 1.2em;
            }

            .intro-message {
                padding: 30px 20px;
            }

            .intro-message h2 {
                font-size: 2em;
            }

            .gallery {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .gallery-item img {
                height: 300px;
            }

            .lightbox-nav {
                font-size: 30px;
                padding: 10px;
            }

            .lightbox-thumbnails {
                display: none;
            }

            .lightbox img {
                max-height: 60vh;
            }
        }

        /* Lasting effekt */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }
        /* Bildebok (flipbook) */
        .book-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            z-index: 1100;
            justify-content: center;
            align-items: center;
            padding: 30px;
        }

        .book-modal.active { display: flex; }

        .book-container {
            width: min(1100px, 95%);
            height: min(700px, 85%);
            background: linear-gradient(180deg,#fff,#f7f7f7);
            border-radius: 10px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.6);
            display: flex;
            position: relative;
            overflow: hidden;
            align-items: center;
            justify-content: center;
            padding: 30px;
        }

        .book-spread {
            display: flex;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
            gap: 20px;
            perspective: 2000px;
        }

        .page {
            flex: 1 1 50%;
            height: 100%;
            background: #fff;
            border-radius: 6px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
            transform-origin: left center;
            transition: transform 0.6s ease;
        }

        .page img { width: 100%; height: 100%; object-fit: cover; display: block; }

        .page.left { transform-origin: right center; }
        .page.flipping { transform: rotateY(-160deg); }

        .book-nav { position: absolute; top: 50%; transform: translateY(-50%); font-size: 40px; color: #8b0000; cursor: pointer; user-select: none; }
        .book-prev { left: 10px; }
        .book-next { right: 10px; }

        .book-close { position: absolute; top: 12px; right: 18px; font-size: 34px; color: var(--gold); cursor: pointer; }

    </style>
    <style>
        /* Music toggle button */
        .music-toggle {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
            color: #fff;
            box-shadow: 0 8px 20px rgba(2,6,23,0.6);
            cursor: pointer;
            z-index: 1300;
            font-size: 20px;
        }

        .music-toggle.playing {
            background: linear-gradient(180deg, var(--gold), var(--amber));
            color: #08121a;
        }
    </style>
</head>
<body>
    <!-- SnÃ¸fall -->
    <div id="snowfall"></div>

    <!-- Header -->
    <div class="header">
        <div class="string-lights" aria-hidden="true">
            <span></span><span></span><span></span><span></span><span></span>
            <span></span><span></span><span></span><span></span><span></span>
        </div>
        <h1 class="floating">VÃ¥rt Julealbum 2024</h1>
        <p class="hearts">â¤ï¸ Meghna & Kanish â¤ï¸</p>
        <p>En reise gjennom vÃ¥r magiske vinter sammen</p>
    </div>

    <div class="container">
        <!-- Intro melding -->
        <div class="intro-message">
            <h2>Til min one and only Pondati â¤ï¸</h2>
            <p>
               Dette er tin gvi har gjort sammmen i julen ma, og jeg ville bare si hvor mye jeg elsker deg og hvordan ingen har fÃ¥tt meg til Ã¥ fÃ¸le meg sÃ¥ bra som du gjÃ¸r. jeg elsker deg sÃ¥ mye thangam og jeg gjÃ¸r hva som helst for Ã¥ aldri miste deg kuttyma, my one and only pondati, amma i love you...
            </p>
            <p style="margin-top: 20px; font-style: italic;">
                God jul, min elskede! ðŸŽ„âœ¨
            </p>
        </div>

        <!-- Galleri -->
        <div class="gallery" id="gallery">
            <!-- Bildene vil bli lastet inn her -->
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <p>ðŸŽ… God Jul & Godt NyttÃ¥r 2025 ðŸŽ…</p>
        <p class="love-message">All My Love, Forever â¤ï¸</p>
        <p style="margin-top: 20px; font-size: 0.9em; color: #fff;">Made with â¤ï¸ for Meghna</p>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <span class="lightbox-close" id="lightbox-close">&times;</span>
        <span class="lightbox-nav lightbox-prev" id="lightbox-prev">â®</span>
        <span class="lightbox-nav lightbox-next" id="lightbox-next">â¯</span>
        <div class="lightbox-content">
            <img src="" alt="" id="lightbox-img">
            <div class="lightbox-caption" id="lightbox-caption"></div>
            <div class="lightbox-counter" id="lightbox-counter"></div>
        </div>
        <div class="lightbox-thumbnails" id="lightbox-thumbnails"></div>
    </div>

    <!-- Bildebok modal -->
    <div class="book-modal" id="book-modal">
        <div class="book-container">
            <div class="book-close" id="book-close">&times;</div>
            <div class="book-nav book-prev" id="book-prev">â®</div>
            <div class="book-spread" id="book-spread">
                <div class="page left" id="book-left"><img src="" alt=""></div>
                <div class="page right" id="book-right"><img src="" alt=""></div>
            </div>
            <div class="book-nav book-next" id="book-next">â¯</div>
        </div>
    </div>

        <!-- Background music + toggle -->
        <audio id="bg-music" src="music.mp3" loop preload="auto"></audio>
        <div id="music-toggle" class="music-toggle" title="Toggle music">â™«</div>
        <div id="theme-toggle" class="music-toggle" title="Toggle theme">ðŸŽ„</div>

    <script>
        // Bilder og videoer array - VÃ¥rt magiske julealbum 2024 â¤ï¸
        const images = [
            // ðŸ“¸ Alle bildene - BILDE 1 til BILDE 72 (med mellomrom i navnet)
            { src: 'bilder/BILDE 1.jpg', alt: 'Juleminne 1 - VÃ¥rt eventyr sammen', type: 'image' },
            { src: 'bilder/BILDE 2.jpg', alt: 'Juleminne 2 - Magiske Ã¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 3.jpg', alt: 'Juleminne 3 - Kjærlighet og lykke', type: 'image' },
            { src: 'bilder/BILDE 4.jpg', alt: 'Juleminne 4 - Sammen for alltid', type: 'image' },
            { src: 'bilder/BILDE 5.jpg', alt: 'Juleminne 5 - Romantiske stunder', type: 'image' },
            { src: 'bilder/BILDE 6.jpg', alt: 'Juleminne 6 - Julestemning', type: 'image' },
            { src: 'bilder/BILDE 7.jpg', alt: 'Juleminne 7 - VÃ¥re Ã¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 8.jpg', alt: 'Juleminne 8 - Perfekte minner', type: 'image' },
            { src: 'bilder/BILDE 9.jpg', alt: 'Juleminne 9 - KjÃ¦rlig klem', type: 'image' },
            { src: 'bilder/BILDE 10.jpg', alt: 'Juleminne 10 - Vakre stunder', type: 'image' },
            { src: 'bilder/BILDE 11.jpg', alt: 'Juleminne 11 - Oss to', type: 'image' },
            { src: 'bilder/BILDE 12.jpg', alt: 'Juleminne 12 - Juletid', type: 'image' },
            { src: 'bilder/BILDE 13.jpg', alt: 'Juleminne 13 - Sammen', type: 'image' },
            { src: 'bilder/BILDE 14.jpg', alt: 'Juleminne 14 - Kos og hygge', type: 'image' },
            { src: 'bilder/BILDE 15.jpg', alt: 'Juleminne 15 - Eventyr', type: 'image' },
            { src: 'bilder/BILDE 16.jpg', alt: 'Juleminne 16 - Lykkelige Ã¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 17.jpg', alt: 'Juleminne 17 - Julemagi', type: 'image' },
            { src: 'bilder/BILDE 18.jpg', alt: 'Juleminne 18 - KjÃ¦rlighet', type: 'image' },
            { src: 'bilder/BILDE 19.jpg', alt: 'Juleminne 19 - Romantikk', type: 'image' },
            { src: 'bilder/BILDE 20.jpg', alt: 'Juleminne 20 - SÃ¸te stunder', type: 'image' },
            { src: 'bilder/BILDE 21.jpg', alt: 'Juleminne 21 - VÃ¥r historie', type: 'image' },
            { src: 'bilder/BILDE 22.jpg', alt: 'Juleminne 22 - Magisk jul', type: 'image' },
            { src: 'bilder/BILDE 23.jpg', alt: 'Juleminne 23 - KjÃ¦re minner', type: 'image' },
            { src: 'bilder/BILDE 24.jpg', alt: 'Juleminne 24 - For alltid sammen', type: 'image' },
            { src: 'bilder/BILDE 25.jpg', alt: 'Juleminne 25 - Julekos', type: 'image' },
            { src: 'bilder/BILDE 26.jpg', alt: 'Juleminne 26 - VÃ¥rt Ã¥r', type: 'image' },
            { src: 'bilder/BILDE 27.jpg', alt: 'Juleminne 27 - Lykkelige dager', type: 'image' },
            { src: 'bilder/BILDE 28.jpg', alt: 'Juleminne 28 - KjÃ¦rlighetsÃ¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 29.jpg', alt: 'Juleminne 29 - Sammen i juletiden', type: 'image' },
            { src: 'bilder/BILDE 30.jpg', alt: 'Juleminne 30 - Romantiske minner', type: 'image' },
            { src: 'bilder/BILDE 31.jpg', alt: 'Juleminne 31 - Vakre Ã¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 32.jpg', alt: 'Juleminne 32 - Oss to sammen', type: 'image' },
            { src: 'bilder/BILDE 33.jpg', alt: 'Juleminne 33 - Juleminner', type: 'image' },
            { src: 'bilder/BILDE 34.jpg', alt: 'Juleminne 34 - KjÃ¦rlighet og glede', type: 'image' },
            { src: 'bilder/BILDE 35.jpg', alt: 'Juleminne 35 - Magiske stunder', type: 'image' },
            { src: 'bilder/BILDE 36.jpg', alt: 'Juleminne 36 - VÃ¥rt eventyr', type: 'image' },
            { src: 'bilder/BILDE 37.jpg', alt: 'Juleminne 37 - Sammen for alltid', type: 'image' },
            { src: 'bilder/BILDE 38.jpg', alt: 'Juleminne 38 - Julestemning', type: 'image' },
            { src: 'bilder/BILDE 39.jpg', alt: 'Juleminne 39 - KjÃ¦re Ã¸yeblikk', type: 'image' },
            { src: 'bilder/BILDE 40.jpg', alt: 'Juleminne 40 - Lykkelige sammen', type: 'image' },
            { src: 'bilder/BILDE 41.jpg', alt: 'Juleminne 41 - Romantisk jul', type: 'image' },
            { src: 'bilder/BILDE 42.jpg', alt: 'Juleminne 42 - Vakre minner', type: 'image' },
            { src: 'bilder/BILDE 43.jpg', alt: 'Juleminne 43 - Oss to i juletid', type: 'image' },
            { src: 'bilder/BILDE 44.jpg', alt: 'Juleminne 44 - KjÃ¦rlighetsreise', type: 'image' },
            { src: 'bilder/BILDE 45.jpg', alt: 'Juleminne 45 - Magisk sammen', type: 'image' },
            { src: 'bilder/BILDE 46.jpg', alt: 'Juleminne 46 - Julemagi', type: 'image' },
            { src: 'bilder/BILDE 47.jpg', alt: 'Juleminne 47 - Vakker juletid', type: 'image' },
            { src: 'bilder/BILDE 48.jpg', alt: 'Juleminne 48 - KjÃ¦re stunder', type: 'image' },
            { src: 'bilder/BILDE 49.jpg', alt: 'Juleminne 49 - Sammen i lykke', type: 'image' },
            { src: 'bilder/BILDE 50.jpg', alt: 'Juleminne 50 - Romantiske dager', type: 'image' },
            { src: 'bilder/BILDE 51.jpg', alt: 'Juleminne 51 - VÃ¥rt juleeventyr', type: 'image' },
            { src: 'bilder/BILDE 52.jpg', alt: 'Juleminne 52 - KjÃ¦rlighet i julen', type: 'image' },
            { src: 'bilder/BILDE 53.jpg', alt: 'Juleminne 53 - Magiske minner', type: 'image' },
            { src: 'bilder/BILDE 54.jpg', alt: 'Juleminne 54 - VÃ¥r kjærlighet', type: 'image' },
            { src: 'bilder/BILDE 55.jpg', alt: 'Juleminne 55 - Sammen ved juletreet', type: 'image' },
            { src: 'bilder/BILDE 56.jpg', alt: 'Juleminne 56 - Magiske stunder', type: 'image' },
            { src: 'bilder/BILDE 57.jpg', alt: 'Juleminne 57 - Romantikk', type: 'image' },
            { src: 'bilder/BILDE 58.jpg', alt: 'Juleminne 58 - VÃ¥re øyeblikk', type: 'image' },
            { src: 'bilder/BILDE 59.jpg', alt: 'Juleminne 59 - Kjærlige stunder', type: 'image' },
            { src: 'bilder/BILDE 60.jpg', alt: 'Juleminne 60 - Sammen for alltid', type: 'image' },
            { src: 'bilder/BILDE 61.jpg', alt: 'Juleminne 61 - Lykkelige øyeblikk', type: 'image' },
            { src: 'bilder/BILDE 62.jpg', alt: 'Juleminne 62 - Julestemning', type: 'image' },
            { src: 'bilder/BILDE 63.jpg', alt: 'Juleminne 63 - VÃ¥rt eventyr', type: 'image' },
            { src: 'bilder/BILDE 64.jpg', alt: 'Juleminne 64 - Koselige øyeblikk', type: 'image' },
            { src: 'bilder/BILDE 65.jpg', alt: 'Juleminne 65 - Kjærlighet og glede', type: 'image' },
            // ðŸŽ¥ Alle videoene med lyd - VID 1 til VID 8
            ];

        // Generate filename candidates for a given media.src
        function generateCandidates(src) {
            const candidates = new Set();
            if (!src) return [];

            // keep original as first candidate
            candidates.add(src);

            // split name and extension
            const m = src.match(/^(.*?)(\.(jpg|jpeg|png|mp4|mov|heic|webp|gif))?$/i);
            const base = (m && m[1]) || src;
            const ext = (m && m[2]) || '';

            // helper to add variants with possible extensions
            function addVariants(name) {
                // Alle mulige bilde og video formater
                const imageExts = ['.jpg', '.JPG', '.jpeg', '.JPEG', '.png', '.PNG', '.heic', '.HEIC', '.webp', '.WEBP', '.gif', '.GIF'];
                const videoExts = ['.mp4', '.MP4', '.mov', '.MOV', '.avi', '.AVI'];
                const exts = ext ? [
                    ext, 
                    ext.toLowerCase(), 
                    ext.toUpperCase()
                ] : [...imageExts, ...videoExts];
                
                exts.forEach(e => {
                    candidates.add(name + e);
                });
                // also add no-extension form
                candidates.add(name);
            }

            // common separators
            const seps = [' ', '_', '-', '', '%20'];

            // try case variants
            addVariants(base);
            addVariants(base.toLowerCase());
            addVariants(base.toUpperCase());

            // replace spaces and URL-encoded spaces with separators
            seps.forEach(sep => {
                const replaced = base.replace(/(\s+|%20)/g, sep);
                addVariants(replaced);
            });

            // If base ends with a number, generate zero-padded variants
            const numMatch = base.match(/^(.*?)(\d+)$/);
            if (numMatch) {
                const prefix = numMatch[1];
                const num = numMatch[2];
                const n = parseInt(num, 10);
                const pads = [1, 2, 3];
                pads.forEach(width => {
                    const s = String(n).padStart(width, '0');
                    addVariants(prefix + s);
                    // also with separator
                    seps.forEach(sep => addVariants(prefix + sep + s));
                });
                // also try non-padded
                seps.forEach(sep => addVariants(prefix + sep + n));
            }

            return Array.from(candidates);
        }

        // Generer poster (thumbnail) fra en video-kilde (returnerer dataURL)
        function createPosterFromVideo(src, seekTime = 0.25) {
            return new Promise((resolve, reject) => {
                try {
                    const video = document.createElement('video');
                    video.crossOrigin = 'anonymous';
                    video.preload = 'metadata';
                    video.muted = true;
                    video.src = src;

                    const onLoaded = () => {
                        // some videos need a little time to be able to seek
                        const seek = Math.min(seekTime, video.duration / 2 || seekTime);
                        const handler = () => {
                            try {
                                const canvas = document.createElement('canvas');
                                canvas.width = video.videoWidth || 320;
                                canvas.height = video.videoHeight || 180;
                                const ctx = canvas.getContext('2d');
                                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                                const dataURL = canvas.toDataURL('image/jpeg');
                                cleanup();
                                resolve(dataURL);
                            } catch (err) {
                                cleanup();
                                reject(err);
                            }
                        };

                        const cleanup = () => {
                            video.removeEventListener('seeked', handler);
                            video.removeEventListener('error', onError);
                            video.pause();
                            video.src = '';
                        };

                        video.addEventListener('seeked', handler);
                        video.currentTime = seek;
                    };

                    const onError = (e) => {
                        reject(new Error('Video load error for ' + src));
                    };

                    video.addEventListener('loadedmetadata', onLoaded);
                    video.addEventListener('error', onError);
                } catch (err) {
                    reject(err);
                }
            });
        }

        // Last inn bilder og videoer i galleriet
        const gallery = document.getElementById('gallery');
        images.forEach((media, index) => {
            const item = document.createElement('div');
            item.className = 'gallery-item';
            
            if (media.type === 'video') {
                const videoType = media.src.toLowerCase().endsWith('.mov') ? 'video/quicktime' : 'video/mp4';
                item.innerHTML = `
                    <video controls preload="metadata" data-index="${index}">
                        <source src="${media.src}" type="${videoType}">
                    </video>
                    <div class="play-icon" style="background: rgba(255,215,0,0.9); font-size: 40px; padding: 20px;">â VIDEO</div>
                `;
                const video = item.querySelector('video');
                item.addEventListener('click', () => {
                    if (video.paused) {
                        video.play();
                    } else {
                        video.pause();
                    }
                });
            }">
                        <source src="${media.src}" type="${videoType}">
                    </video>
                    <div class="play-icon">â–¶</div>
                `;
                const video = item.querySelector('video');
                item.addEventListener('mouseenter', () => video.play());
                item.addEventListener('mouseleave', () => {
                    video.pause();
                    video.currentTime = 0;
                });
            } else {
                const img = new Image();
                const formats = generateCandidates(media.src);
                let formatIndex = 0;

                function tryNext() {
                    if (formatIndex < formats.length) {
                        const trySrc = formats[formatIndex++];
                        console.debug('PrÃ¸ver Ã¥ laste bilde:', trySrc);
                        img.src = trySrc;
                    } else {
                        console.warn('Alle formater feilet for bilde:', media.src, 'ForsÃ¸kte:', formats);
                        // Vis en tydelig placeholder i galleriet sÃ¥ brukeren ser at noe mangler
                        item.innerHTML = `<div class="missing-thumb" data-index="${index}">Bilde ikke funnet</div>`;
                        gallery.appendChild(item);
                    }
                }

                img.onload = function() {
                    item.innerHTML = `<img src="${img.src}" alt="${media.alt}" data-index="${index}">`;
                    gallery.appendChild(item);
                };

                img.onerror = tryNext;
                tryNext();
                return;
            }
            
            gallery.appendChild(item);
        });

        // Lightbox funksjonalitet
        let currentIndex = 0;
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxCaption = document.getElementById('lightbox-caption');
        const lightboxCounter = document.getElementById('lightbox-counter');
        const lightboxClose = document.getElementById('lightbox-close');
        const lightboxPrev = document.getElementById('lightbox-prev');
        const lightboxNext = document.getElementById('lightbox-next');
        const lightboxThumbnails = document.getElementById('lightbox-thumbnails');

        // Opprett thumbnails (stÃ¸tter bilder og video)
        images.forEach((media, index) => {
            if (media.type === 'video') {
                const videoType = media.src.toLowerCase().endsWith('.mov') ? 'video/quicktime' : 'video/mp4';
                item.innerHTML = `
                    <video controls preload="metadata" data-index="${index}">
                        <source src="${media.src}" type="${videoType}">
                    </video>
                    <div class="play-icon" style="background: rgba(255,215,0,0.9); font-size: 40px; padding: 20px;">â VIDEO</div>
                `;
                const video = item.querySelector('video');
                item.addEventListener('click', () => {
                    if (video.paused) {
                        video.play();
                    } else {
                        video.pause();
                    }
                });
            } catch (e) {}
                }).catch(() => {
                    console.warn('Kunne ikke generere poster for', media.src);
                });
                thumb.addEventListener('mouseenter', () => thumb.play());
                thumb.addEventListener('mouseleave', () => { thumb.pause(); thumb.currentTime = 0; });
                thumb.addEventListener('click', () => { currentIndex = index; showLightbox(); });
                lightboxThumbnails.appendChild(thumb);
            } else {
                // Robust image thumbnail loading: prÃ¸v en rekke kandidat-filenavn
                const candidates = generateCandidates(media.src);
                let tryIndex = 0;
                const imgLoader = new Image();

                imgLoader.onload = function() {
                    const img = document.createElement('img');
                    img.src = imgLoader.src;
                    img.alt = media.alt;
                    img.className = 'lightbox-thumbnail';
                    img.dataset.index = index;
                    img.addEventListener('click', () => { currentIndex = index; showLightbox(); });
                    lightboxThumbnails.appendChild(img);
                };

                imgLoader.onerror = function() {
                    if (tryIndex < candidates.length) {
                        console.debug('Thumbnail prÃ¸ver:', candidates[tryIndex]);
                        imgLoader.src = candidates[tryIndex++];
                    } else {
                        console.warn('Thumbnail mangler for', media.src, 'forsÃ¸kte:', candidates);
                        const placeholder = document.createElement('div');
                        placeholder.className = 'lightbox-thumbnail missing-thumb';
                        placeholder.textContent = 'Bilde ikke funnet';
                        placeholder.dataset.index = index;
                        placeholder.addEventListener('click', () => { currentIndex = index; showLightbox(); });
                        lightboxThumbnails.appendChild(placeholder);
                    }
                };

                // start fÃ¸rste forsÃ¸k
                tryIndex = 1;
                imgLoader.src = candidates[0];
            }
        });

        // Ã…pne lightbox
        gallery.addEventListener('click', (e) => {
            const target = e.target.tagName === 'VIDEO' ? e.target : e.target.tagName === 'IMG' ? e.target : null;
            if (target && target.dataset.index !== undefined) {
                currentIndex = parseInt(target.dataset.index);
                showLightbox();
            }
        });

        function showLightbox() {
            const currentMedia = images[currentIndex];
            const lightboxContent = document.querySelector('.lightbox-content');
            
            // Fjern gammelt innhold
            const oldMedia = lightboxContent.querySelector('img, video');
            if (oldMedia) oldMedia.remove();
            
            if (currentMedia.type === 'video') {
                const video = document.createElement('video');
                video.id = 'lightbox-img';
                video.controls = true;
                video.autoplay = false; // don't force autoplay with sound (browsers may block)
                video.muted = false; // allow audio when user presses play
                video.style.maxWidth = '100%';
                video.style.maxHeight = '70vh';
                video.style.borderRadius = '15px';
                video.style.border = '5px solid var(--gold)';
                video.style.boxShadow = '0 0 50px rgba(255, 215, 0, 0.5)';

                const source = document.createElement('source');
                source.src = currentMedia.src;
                source.type = currentMedia.src.toLowerCase().endsWith('.mov') ? 'video/quicktime' : 'video/mp4';
                video.appendChild(source);

                // sett poster i lightbox hvis mulig
                createPosterFromVideo(currentMedia.src).then(poster => {
                    try { video.setAttribute('poster', poster); } catch (e) {}
                }).catch(() => {
                    console.warn('Kunne ikke generere lightbox poster for', currentMedia.src);
                });

                // logg eventuelle feil ved lasting
                video.addEventListener('error', (e) => {
                    console.error('Feil ved lasting av video i lightbox:', currentMedia.src, e);
                });

                lightboxContent.insertBefore(video, lightboxCaption);
                // focus video so user can easily press play
                setTimeout(() => { video.focus(); }, 100);
            } else {
                const img = document.createElement('img');
                img.id = 'lightbox-img';
                // prefer the actual displayed gallery src if available (resolved extension/variant)
                const galleryImg = document.querySelector(`img[data-index="${currentIndex}"]`);
                img.src = (galleryImg && galleryImg.src) ? galleryImg.src : currentMedia.src;
                img.alt = currentMedia.alt;
                lightboxContent.insertBefore(img, lightboxCaption);
            }
            
            lightboxCaption.textContent = currentMedia.alt;
            lightboxCounter.textContent = `${currentIndex + 1} / ${images.length}`;
            lightbox.classList.add('active');
            
            // Oppdater aktiv thumbnail
            const thumbs = lightboxThumbnails.querySelectorAll('.lightbox-thumbnail');
            thumbs.forEach((thumb, index) => {
                thumb.classList.toggle('active', index === currentIndex);
            });
            
            // Scroll thumbnail til synlig
            const activeThumb = thumbs[currentIndex];
            if (activeThumb) {
                activeThumb.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
        }

        // --- Bildebok funksjonalitet ---
        const bookModal = document.getElementById('book-modal');
        const bookLeft = document.getElementById('book-left');
        const bookRight = document.getElementById('book-right');
        const bookPrev = document.getElementById('book-prev');
        const bookNext = document.getElementById('book-next');
        const bookClose = document.getElementById('book-close');

        // Lag liste med kun bilder (ikke videoer) for bokvisning
        const imageItems = images.filter(m => m.type === 'image');

        function normalizeName(name) {
            if (!name) return '';
            return name.toString().toLowerCase().replace(/\.(jpg|jpeg|png|gif|bmp|webp)$/i, '').replace(/[_\-\s]/g, '');
        }

        let bookIndex = 0; // index in imageItems (0-based)

        function openBookAtImage(globalIndex) {
            // find corresponding index in imageItems based on src
            const src = images[globalIndex].src;
            const target = normalizeName(src);
            const idx = imageItems.findIndex(it => normalizeName(it.src) === target);
            bookIndex = idx >= 0 ? idx : 0;
            showBookSpread();
            bookModal.classList.add('active');
        }

        function showBookSpread() {
            const left = imageItems[bookIndex];
            const right = imageItems[bookIndex + 1];
            // resolve src (basic)
            function resolveDisplayedSrc(original) {
                if (!original) return '';
                const imgs = document.querySelectorAll('img[data-index]');
                const target = normalizeName(original.src || original);
                for (const i of imgs) {
                    if (normalizeName(i.src) === target) return i.src;
                }
                return original.src || '';
            }

            bookLeft.querySelector('img').src = left ? resolveDisplayedSrc(left) : '';
            bookLeft.querySelector('img').alt = left ? left.alt : '';
            if (right) {
                bookRight.querySelector('img').src = resolveDisplayedSrc(right);
                bookRight.querySelector('img').alt = right.alt;
            } else {
                bookRight.querySelector('img').src = '';
                bookRight.querySelector('img').alt = '';
            }
        }

        function nextBookPage() {
            if (bookIndex + 2 < imageItems.length) {
                // quick flip animation on left page
                bookLeft.classList.add('flipping');
                setTimeout(() => {
                    bookLeft.classList.remove('flipping');
                    bookIndex += 2;
                    showBookSpread();
                }, 550);
            }
        }

        function prevBookPage() {
            if (bookIndex - 2 >= 0) {
                bookRight.classList.add('flipping');
                setTimeout(() => {
                    bookRight.classList.remove('flipping');
                    bookIndex -= 2;
                    showBookSpread();
                }, 550);
            }
        }

        bookNext.addEventListener('click', nextBookPage);
        bookPrev.addEventListener('click', prevBookPage);
        bookClose.addEventListener('click', () => bookModal.classList.remove('active'));

        // close book on outside click
        bookModal.addEventListener('click', (e) => {
            if (e.target === bookModal) bookModal.classList.remove('active');
        });

        // keyboard navigation for book
        document.addEventListener('keydown', (e) => {
            if (bookModal.classList.contains('active')) {
                if (e.key === 'ArrowRight') nextBookPage();
                else if (e.key === 'ArrowLeft') prevBookPage();
                else if (e.key === 'Escape') bookModal.classList.remove('active');
            }
        });

        // double-click on gallery image opens book at that image (if image)
        gallery.addEventListener('dblclick', (e) => {
            const img = e.target.tagName === 'IMG' ? e.target : null;
            if (img && img.dataset && img.dataset.index) {
                const globalIndex = parseInt(img.dataset.index, 10);
                if (images[globalIndex].type === 'image') openBookAtImage(globalIndex);
            }
        });

        // Lukk lightbox
        lightboxClose.addEventListener('click', () => {
            lightbox.classList.remove('active');
        });

        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
                lightbox.classList.remove('active');
            }
        });

        // Navigasjon
        lightboxPrev.addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            showLightbox();
        });

        lightboxNext.addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % images.length;
            showLightbox();
        });

        // Tastatur navigasjon
        document.addEventListener('keydown', (e) => {
            if (lightbox.classList.contains('active')) {
                if (e.key === 'ArrowLeft') {
                    currentIndex = (currentIndex - 1 + images.length) % images.length;
                    showLightbox();
                } else if (e.key === 'ArrowRight') {
                    currentIndex = (currentIndex + 1) % images.length;
                    showLightbox();
                } else if (e.key === 'Escape') {
                    lightbox.classList.remove('active');
                }
            }
        });

        // SnÃ¸fall animasjon
        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            snowflake.innerHTML = ['â„', 'â…', 'â†'][Math.floor(Math.random() * 3)];
            snowflake.style.left = Math.random() * 100 + '%';
            snowflake.style.animationDuration = Math.random() * 3 + 5 + 's';
            snowflake.style.opacity = Math.random() * 0.6 + 0.4;
            snowflake.style.fontSize = Math.random() * 10 + 10 + 'px';
            
            document.getElementById('snowfall').appendChild(snowflake);

            setTimeout(() => {
                snowflake.remove();
            }, 8000);
        }

        // Opprett snÃ¸fnugg kontinuerlig
        setInterval(createSnowflake, 200);

        // Opprett initial snÃ¸
        for (let i = 0; i < 30; i++) {
            setTimeout(createSnowflake, i * 100);
        }

        // Background music toggle logic
        (function() {
            const audio = document.getElementById('bg-music');
            const btn = document.getElementById('music-toggle');

            function setPlayingUI(isPlaying) {
                if (isPlaying) {
                    btn.classList.add('playing');
                    btn.textContent = 'ðŸ”Š';
                } else {
                    btn.classList.remove('playing');
                    btn.textContent = 'â™«';
                }
            }

            // Restore preference
            const pref = localStorage.getItem('musicEnabled');
            if (pref === 'true') {
                // try to play, may be blocked until user interacts
                audio.play().then(() => setPlayingUI(true)).catch(() => setPlayingUI(false));
            } else {
                setPlayingUI(false);
            }

            btn.addEventListener('click', () => {
                if (audio.paused) {
                    audio.play().then(() => {
                        localStorage.setItem('musicEnabled', 'true');
                        setPlayingUI(true);
                    }).catch(() => {
                        // user gesture required â€” mark as enabled but let user click play in UI
                        localStorage.setItem('musicEnabled', 'true');
                        setPlayingUI(false);
                    });
                } else {
                    audio.pause();
                    localStorage.setItem('musicEnabled', 'false');
                    setPlayingUI(false);
                }
            });
        })();

        // Theme toggle logic (christmas / clean)
        (function() {
            const themeBtn = document.getElementById('theme-toggle');
            const root = document.body;
            const saved = localStorage.getItem('siteTheme') || 'christmas';
            function applyTheme(name) {
                if (name === 'clean') root.setAttribute('data-theme', 'clean');
                else root.removeAttribute('data-theme');
                themeBtn.textContent = name === 'clean' ? 'âšª' : 'ðŸŽ„';
            }
            applyTheme(saved);

            themeBtn.addEventListener('click', () => {
                const current = root.getAttribute('data-theme') === 'clean' ? 'clean' : 'christmas';
                const next = current === 'clean' ? 'christmas' : 'clean';
                applyTheme(next);
                localStorage.setItem('siteTheme', next);
            });
        })();
    </script>
</body>
</html>

